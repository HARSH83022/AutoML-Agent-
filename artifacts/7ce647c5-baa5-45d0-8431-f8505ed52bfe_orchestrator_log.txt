[2025-11-19 15:06:56] Orchestration started
[2025-11-19 15:06:56] START ps_agent attempt=1
[2025-11-19 15:07:34] OK ps_agent
[2025-11-19 15:07:34] START data_agent attempt=1
[2025-11-19 15:07:34] OK data_agent
[2025-11-19 15:07:34] START prep_agent attempt=1
[2025-11-19 15:07:48] ERROR prep_agent: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
Traceback (most recent call last):
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\main.py", line 899, in safe_step
    res = step_fn(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\agents\prep_agent.py", line 478, in preprocess_dataset
    preprocessor, datetime_map2, drop_after, text_cols = _map_plan_to_transformers(reduced_plan, X)
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\agents\prep_agent.py", line 405, in _map_plan_to_transformers
    cat_pipe = Pipeline([("imputer", SimpleImputer(strategy="most_frequent")), ("onehot", OneHotEncoder(handle_unknown="ignore", sparse=False))])
                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'

[2025-11-19 15:07:50] START prep_agent attempt=2
[2025-11-19 15:08:45] ERROR prep_agent: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
Traceback (most recent call last):
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\main.py", line 899, in safe_step
    res = step_fn(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\agents\prep_agent.py", line 478, in preprocess_dataset
    preprocessor, datetime_map2, drop_after, text_cols = _map_plan_to_transformers(reduced_plan, X)
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\agents\prep_agent.py", line 405, in _map_plan_to_transformers
    cat_pipe = Pipeline([("imputer", SimpleImputer(strategy="most_frequent")), ("onehot", OneHotEncoder(handle_unknown="ignore", sparse=False))])
                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'

[2025-11-19 15:08:49] Run FAILED: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'
Traceback (most recent call last):
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\main.py", line 961, in orchestrate_run
    prep = safe_step(
           ^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\main.py", line 909, in safe_step
    raise last_exc
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\main.py", line 899, in safe_step
    res = step_fn(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\agents\prep_agent.py", line 478, in preprocess_dataset
    preprocessor, datetime_map2, drop_after, text_cols = _map_plan_to_transformers(reduced_plan, X)
                                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dell\OneDrive\Desktop\automl-agent\app\agents\prep_agent.py", line 405, in _map_plan_to_transformers
    cat_pipe = Pipeline([("imputer", SimpleImputer(strategy="most_frequent")), ("onehot", OneHotEncoder(handle_unknown="ignore", sparse=False))])
                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: OneHotEncoder.__init__() got an unexpected keyword argument 'sparse'

